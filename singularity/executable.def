# A image to build SMTPlan+
BootStrap: localimage
From: ./build_environment.sif
Stage: build

# Copy source files
%files
    ../src /home/src

# Build SMTPlan+
%post
    cd /home/src
    mkdir build && cd build
    cmake ..
    make -j4


# A image to run SMTPlan+
BootStrap: localimage
From: ./executable_base.sif
Stage: final

%files from build
    /home/src/build/SMTPlan /bin/SMTPlan

%runscript
    /bin/SMTPlan $@